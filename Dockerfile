FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGN1c3RvbS1ydW50aW1lLWNvbm5lY3Rvci1hcGIKZGVzY3JpcHRp\
b246IEN1c3RvbSBSdW50aW1lIENvbm5lY3RvcgpiaW5kYWJsZTogRmFsc2UKYXN5bmM6IG9wdGlv\
bmFsCnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogQ3Vz\
dG9tIFJ1bnRpbWUgQ29ubmVjdG9yCiAgY29uc29sZS5vcGVuc2hpZnQuaW8vaWNvbkNsYXNzOiBm\
YXMgZmEtcGx1ZwogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRwOi8vd3d3LmFlcm9nZWFyLm9yZy9j\
dXN0b20tcnVudGltZS1jb25uZWN0b3IvZG9jdW1lbnRhdGlvbi5odG1sIgogIHByb3ZpZGVyRGlz\
cGxheU5hbWU6ICJSZWQgSGF0LCBJbmMuIgogIGRlcGVuZGVuY2llczogW10KICBzZXJ2aWNlTmFt\
ZTogY3VzdG9tLXJ1bnRpbWUtY29ubmVjdG9yCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAg\
ZGVzY3JpcHRpb246IFRoaXMgZGVmYXVsdCBwbGFuIGRlcGxveXMgY3VzdG9tLXJ1bnRpbWUtY29u\
bmVjdG9yLWFwYgogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6IHt9CiAgICBwYXJhbWV0ZXJz\
OgogICAgLSBuYW1lOiBTRVJWSUNFX05BTUUKICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgdHlw\
ZTogc3RyaW5nCiAgICAgIHRpdGxlOiBTZXJ2aWNlIE5hbWUKICAgIC0gbmFtZTogU0VSVklDRV9V\
UkkKICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBT\
ZXJ2aWNlIFVSTAogICAgLSBuYW1lOiBTRVJWSUNFX0NPTkZJRwogICAgICByZXF1aXJlZDogRmFs\
c2UKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIGRpc3BsYXlfdHlwZTogdGV4dGFyZWEKICAgICAg\
dGl0bGU6IFNlcnZpY2UgSlNPTiBDb25maWd1cmF0aW9u"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
