FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGN1c3RvbS1ydW50aW1lLWNvbm5lY3Rvci1hcGIKZGVzY3JpcHRp\
b246IEN1c3RvbSBSdW50aW1lIENvbm5lY3RvcgpiaW5kYWJsZTogVHJ1ZQphc3luYzogcmVxdWly\
ZWQKdGFnczoKICAtIG1vYmlsZS1zZXJ2aWNlCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBDdXN0\
b20gUnVudGltZSBDb25uZWN0b3IKICBjb25zb2xlLm9wZW5zaGlmdC5pby9pY29uQ2xhc3M6IGZh\
IGZhLXBsdWcKICBkb2N1bWVudGF0aW9uVXJsOiAiaHR0cDovL3d3dy5hZXJvZ2Vhci5vcmcvY3Vz\
dG9tLXJ1bnRpbWUtY29ubmVjdG9yL2RvY3VtZW50YXRpb24uaHRtbCIKICBwcm92aWRlckRpc3Bs\
YXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKICBkZXBlbmRlbmNpZXM6IFtdCiAgc2VydmljZU5hbWU6\
IGN1c3RvbS1ydW50aW1lLWNvbm5lY3RvcgpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRl\
c2NyaXB0aW9uOiBUaGlzIGRlZmF1bHQgcGxhbiBkZXBsb3lzIGN1c3RvbS1ydW50aW1lLWNvbm5l\
Y3Rvci1hcGIKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVyczoK\
ICAgIC0gbmFtZTogU0VSVklDRV9OQU1FCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTog\
U2VydmljZSBOYW1lCiAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAtIG5hbWU6IFNFUlZJQ0VfVVJJ\
CiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogU2VydmljZSBVUkwKICAgICAgcmVxdWly\
ZWQ6IFRydWUKICAgIC0gbmFtZTogU0VSVklDRV9DT05GSUcKICAgICAgZGVmYXVsdDoge30KICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgIGRpc3BsYXlfdHlwZTogdGV4dGFyZWEKICAgICAgdGl0bGU6\
IFNlcnZpY2UgSlNPTiBDb25maWd1cmF0aW9uCiAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgYmlu\
ZF9wYXJhbWV0ZXJzOgogICAgLSBuYW1lOiBDTElFTlRfSUQKICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgIHRpdGxlOiBNb2JpbGUgQ2xpZW50IElkCiAgICAgIHJlcXVpcmVkOiBUcnVl"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars  /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
